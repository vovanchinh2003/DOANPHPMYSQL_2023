if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("LSOptimisticSendAttachmentShareForward",["LSAppendDataTraceAddon","LSInsertOptimisticAttachment","LSIssueNewTaskAndGetTaskID","LSLocalApplyOptimisticMessage","LSPredefineTraceForTask"],function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(e){return c.sp(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],a[3],a[4],a[5],f,f,f,f,[0,3],f,f,f,!0).then(function(a){return a=a,d[0]=a[0],d[1]=a[1],a})},function(e){return c.sp(b("LSInsertOptimisticAttachment"),a[1],d[1],d[0],d[0],a[6],[0,2],f,f,!0,!1)},function(e){return c.i64.gt([0,0],[0,0])?d[2]=c.i64.add(c.i64.of_float(Date.now()),[0,0]):d[2]=[0,0],c.sp(b("LSIssueNewTaskAndGetTaskID"),c.i64.to_string(a[1]),[0,46],"",f,f,[0,0],[0,0],f,f,d[2]).then(function(a){return a=a,d[3]=a[0],a})},function(a){return f!==f?c.seq([function(a){return c.sp(b("LSPredefineTraceForTask"),f,d[3],c.i64.to_string([0,46]),d[0])},function(a){return c.sp(b("LSAppendDataTraceAddon"),f,[0,20],[0,1],f,f)}]):c.resolve()},function(b){return f?d[4]=!1:d[4]=!0,d[4]?(b=[f,f],d[5]=b[0],d[6]=b[1],b):(d[12]=f.get("share_treatment_type"),f,d[13]=f.get("share_treatment_name"),f,b=[d[12],d[13]],d[5]=b[0],d[6]=b[1],b),c.db.table(31).add({taskId:d[3],threadKey:a[1],offlineThreadingId:d[0],threadAttributionSource:a[7],sendType:[0,4],markThreadRead:!1,initiatingSource:a[8]})},function(b){return d[7]=c.createArray(),d[8]=(d[7].push("optimisticSendAttachmentShareForward"),d[7]),d[9]=(d[7].push(a[1]),d[7]),d[10]=(d[7].push(a[6]),d[7]),d[11]=c.toJSON(d[7]),function(a){c.logger(a).info(a)}(d[11]),e[0]=d[0]}])},function(a){return c.resolve(e)}])}e.exports=a},null,typeof self!=="undefined"&&self.document&&self.document.currentScript);
__d("LSOptimisticSendURLShare",["LSInsertOptimisticAttachment","LSIssueNewTaskAndGetTaskID","LSLocalApplyOptimisticMessage"],function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(e){return c.sp(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],a[3],a[4],a[5],f,f,f,f,f,f,f,f,!1).then(function(a){return a=a,d[0]=a[0],d[1]=a[1],a})},function(e){return c.sp(b("LSInsertOptimisticAttachment"),a[1],d[1],d[0],d[0],d[0],[0,7],a[6],f,!1,!0)},function(e){return c.sp(b("LSIssueNewTaskAndGetTaskID"),c.i64.to_string(a[1]),[0,46],"",f,f,[0,0],[0,0],[0,1],f,[0,0]).then(function(a){return a=a,d[2]=a[0],a})},function(b){return c.db.table(31).add({taskId:d[2],threadKey:a[1],offlineThreadingId:d[0],threadAttributionSource:a[7],sendType:[0,6],markThreadRead:!1,initiatingSource:a[8]})},function(b){return d[3]=c.createArray(),d[4]=(d[3].push("optimisticSendURLShare"),d[3]),d[5]=(d[3].push(a[1]),d[3]),d[6]=(d[3].push(a[6]),d[3]),d[7]=c.toJSON(d[3]),function(a){c.logger(a).info(a)}(d[7]),e[0]=d[0]}])},function(a){return c.resolve(e)}])}e.exports=a},null,typeof self!=="undefined"&&self.document&&self.document.currentScript);
__d("LSShareAttachment.bs",["LS.bs","LSDatabaseDeferred.bs","LSMessagingInitiatingSource.bs","LSOptimisticSendAttachmentShareForward","LSOptimisticSendURLShare","LSThreadAttributionTypeUtil.bs","LSTransaction.bs","MessagingThreadType.bs","Promise","bs_belt_Option","bs_caml_format","promiseDone"],function(a,b,c,d,e,f){"use strict";function a(a){var c=b("LSDatabaseDeferred.bs").db.then(function(c){var d=b("bs_caml_format").caml_int64_of_string(a.actorID),e=b("bs_caml_format").caml_int64_of_string(a.targetID),f=a.shareID,g=b("bs_belt_Option").getWithDefault(a.message,""),h=a.targetType,i=h==="group"?b("MessagingThreadType.bs").group:b("MessagingThreadType.bs").oneToOne,j=b("LSThreadAttributionTypeUtil.bs").getSource(e,a.entryPoint);h=b("LSTransaction.bs").run(c,function(c){var h=a.url;if(h!==void 0)return b("LSOptimisticSendURLShare")(d,e,i,g,void 0,!1,h,j,b("LSMessagingInitiatingSource.bs").facebookChat,b("LS.bs").make(c));else return b("LSOptimisticSendAttachmentShareForward")(d,e,i,g,void 0,!1,f,j,b("LSMessagingInitiatingSource.bs").facebookChat,b("LS.bs").make(c))},"readWrite");b("promiseDone")(h,void 0,void 0);return b("Promise").resolve(void 0)});b("promiseDone")(c,void 0,void 0)}f.share=a},null,typeof self!=="undefined"&&self.document&&self.document.currentScript);
__d("LSShareAttachment.re",["LSShareAttachment.bs"],function(a,b,c,d,e,f){a=b("LSShareAttachment.bs").share;f.share=a},null,typeof self!=="undefined"&&self.document&&self.document.currentScript);